<story-context id=".bmad/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>0</epicId>
    <storyId>0.2</storyId>
    <title>Initialize FastAPI Backend</title>
    <status>drafted</status>
    <generatedAt>fredag 28. november 2025</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/sprint-artifacts/epic-0/story-0-2/0-2-initialize-fastapi-backend.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>Backend Developer</asA>
    <iWant>set up a Python FastAPI project structure</iWant>
    <soThat>I have a high-performance, type-safe backend foundation for building API endpoints</soThat>
    <tasks>
- [ ] Initialize Python project with `uv` in `backend/` (AC: #1)
  - [ ] Run `uv init` inside `backend/` directory
  - [ ] Configure `pyproject.toml`
- [ ] Install core dependencies (AC: #2)
  - [ ] `uv add fastapi uvicorn`
  - [ ] `uv add supabase python-dotenv pydantic`
- [ ] Create project directory structure (AC: #3)
  - [ ] Create `backend/app/__init__.py`
  - [ ] Create `backend/app/main.py`
  - [ ] Create `backend/app/api/`
  - [ ] Create `backend/app/core/`
- [ ] Implement basic application entry point in `main.py` (AC: #4, #6)
  - [ ] Initialize `FastAPI` app instance
  - [ ] Add root route (`GET /`) returning `{"message": "Hello World"}`
- [ ] Configure CORS Middleware (AC: #5)
  - [ ] Allow origins: `http://localhost:3000`
  - [ ] Allow credentials, methods, and headers
- [ ] Verify server startup and access (AC: #4, #6)
  - [ ] Run `uv run uvicorn app.main:app --reload --port 8000`
  - [ ] Curl `localhost:8000` to verify response
</tasks>
  </story>

  <acceptanceCriteria>
1.  Python environment set up (using `uv`)
2.  FastAPI installed and configured
3.  Basic directory structure created (`app/`, `app/api`, `app/core`)
4.  "Hello World" endpoint working on `localhost:8000`
5.  CORS configured to allow requests from Frontend (`localhost:3000`)
6.  Server runs via `uvicorn`
</acceptanceCriteria>

  <artifacts>
    <docs>
      <doc>
        <path>docs/sprint-artifacts/tech-spec-epic-0.md</path>
        <title>Epic Technical Specification: Project Initialization &amp; Environment Setup</title>
        <section>Backend Initialization</section>
        <snippet>Setting up a Python 3.12+ environment with FastAPI using `uv`. Installing `fastapi`, `uvicorn`, `supabase`, `pydantic-ai`.</snippet>
      </doc>
      <doc>
        <path>docs/architecture.md</path>
        <title>Scale Adaptive Architecture</title>
        <section>Project Initialization &amp; Structure</section>
        <snippet>Backend Setup commands: mkdir backend; cd backend; uv init; uv add fastapi uvicorn supabase python-dotenv pydantic pydantic-ai google-generativeai</snippet>
      </doc>
      <doc>
        <path>docs/architecture.md</path>
        <title>Scale Adaptive Architecture</title>
        <section>Security &amp; Environment</section>
        <snippet>backend/.env: SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY, SUPABASE_JWT_SECRET, GEMINI_API_KEY</snippet>
      </doc>
    </docs>
    <code>
      <!-- No existing backend code to reference yet as this is the initialization story -->
    </code>
    <dependencies>
      <dependency>
        <ecosystem>Python</ecosystem>
        <package>fastapi</package>
        <version>latest</version>
      </dependency>
      <dependency>
        <ecosystem>Python</ecosystem>
        <package>uvicorn</package>
        <version>latest</version>
      </dependency>
      <dependency>
        <ecosystem>Python</ecosystem>
        <package>supabase</package>
        <version>latest</version>
      </dependency>
      <dependency>
        <ecosystem>Python</ecosystem>
        <package>python-dotenv</package>
        <version>latest</version>
      </dependency>
      <dependency>
        <ecosystem>Python</ecosystem>
        <package>pydantic</package>
        <version>latest</version>
      </dependency>
    </dependencies>
  </artifacts>

  <constraints>
    <constraint>Backend Framework: FastAPI (0.110+)</constraint>
    <constraint>Language: Python 3.12+</constraint>
    <constraint>Project Manager: uv (for dependency resolution)</constraint>
    <constraint>Monorepo Structure: backend/ directory at project root</constraint>
    <constraint>Port: 8000</constraint>
    <constraint>CORS: Must allow http://localhost:3000</constraint>
  </constraints>
  <interfaces>
    <interface>
      <name>Health Check</name>
      <kind>REST Endpoint</kind>
      <signature>GET /</signature>
      <path>backend/app/main.py</path>
    </interface>
  </interfaces>
  <tests>
    <standards>Manual verification of server startup and endpoint access using curl or browser.</standards>
    <locations>None yet</locations>
    <ideas>
      <idea>Verify `uv run uvicorn` starts without errors</idea>
      <idea>Curl localhost:8000 returns 200 OK</idea>
      <idea>Verify CORS headers are present in response</idea>
    </ideas>
  </tests>
</story-context>
