<story-context id="4-3-quiz-progress-tracking" v="1.1">
  <metadata>
    <epicId>epic-4</epicId>
    <storyId>4.3</storyId>
    <title>Quiz Progress Tracking</title>
    <status>drafted</status>
    <generatedAt>2025-12-05</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/sprint-artifacts/epic-4/story-4-3-quiz-progress-tracking/4-3-quiz-progress-tracking.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>Student</asA>
    <iWant>see my progress through the quiz (e.g., "Question 3 of 10")</iWant>
    <soThat>I know how many questions are remaining and can manage my time</soThat>
    <tasks>
      - [ ] **Backend - API Update:** Ensure `GET /api/v1/quiz/{quiz_id}/start` or a new progress endpoint returns `current_question_index` and `total_questions` for the active attempt. (AC: #1)
      - [ ] **Frontend - Component Creation:** Create a `QuizProgressBar` component (or similar) to visualize progress. (AC: #1)
      - [ ] **Frontend - Integration:** Integrate `QuizProgressBar` into `app/quiz/[quizId]/page.tsx`. (AC: #1)
      - [ ] **Test - Frontend:** Write component tests for `QuizProgressBar` ensuring correct visual width/text. (AC: #1)
    </tasks>
  </story>

  <acceptanceCriteria>
    1.  A progress bar or question counter (e.g., "3/10") is visible during the quiz. (FR015)
  </acceptanceCriteria>

  <artifacts>
    <docs>
      <doc>
        <path>docs/PRD.md</path>
        <title>Product Requirements Document</title>
        <section>Functional Requirements</section>
        <snippet>FR015: Quiz Progress Bar: The quiz interface shall include a progress bar for user orientation.</snippet>
      </doc>
      <doc>
        <path>docs/sprint-artifacts/tech-spec-epic-4.md</path>
        <title>Epic 4 Technical Specification</title>
        <section>Story 4.3: Quiz Progress Tracking</section>
        <snippet>A progress bar or question counter (e.g., "3/10") is visible during the quiz. (FR015)</snippet>
      </doc>
      <doc>
        <path>docs/architecture.md</path>
        <title>Scale Adaptive Architecture</title>
        <section>Epic Mapping &amp; Naming Conventions</section>
        <snippet>
          Epic 4: Quiz Experience | QuizPlayer, ScoreCard | quiz_submission.py | quizzes, questions, submissions
          TS/React Components: PascalCase (e.g., QuizCard.tsx)
          Data Access: Frontend calls FastAPI Backend for ALL data. Frontend never queries the Database directly.
        </snippet>
      </doc>
      <doc>
        <path>docs/design-specification.md</path>
        <title>Design Specification</title>
        <section>Color Palette &amp; Components</section>
        <snippet>
          Primary Color: #D0BB95 (bg-primary)
          Accent Blue: #007AFF (bg-accent-blue)
          Components: Buttons (Primary/Secondary/Ghost), Cards (rounded-xl, shadow-soft).
          Progress Bar: Use Tailwind utility classes matching the primary or accent colors.
        </snippet>
      </doc>
      <doc>
        <path>docs/sprint-artifacts/epic-4/story-4-2-immediate-answer-feedback/4-2-immediate-answer-feedback.md</path>
        <title>Story 4.2: Immediate Answer Feedback</title>
        <section>Learnings from Previous Story</section>
        <snippet>The "Next Question" button logic needs to be fully operational to advance the progress bar. This story should ensure the "Next" flow increments the counter.</snippet>
      </doc>
    </docs>
    <code>
      <ref>
        <path>frontend/app/quiz/[quizId]/page.tsx</path>
        <kind>component</kind>
        <symbol>QuizPage</symbol>
        <lines>6-95</lines>
        <reason>Main quiz orchestration page where the progress bar will be integrated.</reason>
      </ref>
      <ref>
        <path>backend/app/services/quiz_submission.py</path>
        <kind>service</kind>
        <symbol>quiz_submission</symbol>
        <lines>3-end</lines>
        <reason>Backend service that handles quiz logic and should provide progress data.</reason>
      </ref>
      <ref>
        <path>backend/app/models/quiz_submission.py</path>
        <kind>model</kind>
        <symbol>QuizAttempt</symbol>
        <lines>23-end</lines>
        <reason>Pydantic model representing a quiz attempt, likely storing current progress.</reason>
      </ref>
      <ref>
        <path>backend/app/api/routers/quiz.py</path>
        <kind>router</kind>
        <symbol>quiz_router</symbol>
        <lines>7-end</lines>
        <reason>API router defining endpoints for quiz interaction, including start/resume.</reason>
      </ref>
    </code>
    <dependencies>
      <dep ecosystem="npm">next</dep>
      <dep ecosystem="npm">react</dep>
      <dep ecosystem="npm">tailwindcss</dep>
      <dep ecosystem="npm">@tanstack/react-query</dep>
      <dep ecosystem="python">fastapi</dep>
      <dep ecosystem="python">pydantic</dep>
      <dep ecosystem="python">supabase</dep>
    </dependencies>
  </artifacts>

  <constraints>
    - Frontend: Must use Next.js App Router and Tailwind CSS.
    - Backend: Logic must reside in `quiz_submission.py` service.
    - State: Manage quiz state (index) in `QuizPlayer` or parent page.
    - UI: Use `shadcn/ui` Progress component if available, else custom Tailwind implementation using Primary (#D0BB95) or Accent colors.
  </constraints>

  <interfaces>
    <interface>
      <name>GET /api/v1/quiz/{quiz_id}/start</name>
      <kind>REST Endpoint</kind>
      <signature>QuizStartResponse</signature>
      <path>backend/app/api/routers/quiz.py</path>
    </interface>
    <interface>
      <name>QuizAttempt</name>
      <kind>Pydantic Model</kind>
      <signature>class QuizAttempt(BaseModel)</signature>
      <path>backend/app/models/quiz_submission.py</path>
    </interface>
  </interfaces>

  <tests>
    <standards>
      Frontend tests using Jest and React Testing Library. Backend tests using Pytest.
    </standards>
    <locations>
      frontend/tests/components/
      backend/tests/
    </locations>
    <ideas>
      <idea id="1">Test `QuizProgressBar` renders correct width/text for 0%, 50%, 100% progress.</idea>
      <idea id="2">Verify `QuizPage` passes correct index/total to progress bar.</idea>
      <idea id="3">Backend test ensuring start/resume returns correct progress state.</idea>
    </ideas>
  </tests>
</story-context>